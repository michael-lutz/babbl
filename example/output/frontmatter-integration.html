<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name=title content=Frontmatter Parsing>
<meta name=author content=Michael Lutz>
<meta name=date content=2025-07-02>
<title>Frontmatter Parsing</title>
<style>
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', sans-serif;
    line-height: 1.6;
    max-width: 750px;
    margin: 0 auto;
    padding: 1.5rem;
    color: #333;
    background-color: #fff;
}

section {
    padding: 0;
}

.title {
    font-size: 2.0rem;
    margin-top: 1.0rem;
    margin-bottom: 0.0rem;
    color: #333;
    font-weight: 600;
}

.heading-1 { 
    font-size: 1.6rem; 
    margin-top: 1.0rem; 
    margin-bottom: 0.5rem; 
    color: #333;
    font-weight: 600;
}

.heading-2 { 
    font-size: 1.4rem; 
    margin-top: 1rem; 
    margin-bottom: 0.5rem; 
    color: #333;
    font-weight: 600;
}

.heading-3 { 
    font-size: 1.2rem; 
    margin-top: 1.0rem; 
    margin-bottom: 0.5rem; 
    color: #333;
    font-weight: 600;
}

.heading-4, .heading-5, .heading-6 { 
    font-size: 1rem; 
    margin-top: 1rem; 
    margin-bottom: 0.5rem; 
    color: #333;
    font-weight: 600;
}

.paragraph { 
    margin-bottom: 1rem; 
    text-align: left;
    font-size: .9rem;
}

.code-block { 
    background: #f5f5f5; 
    padding: 1rem; 
    border: none;
    overflow-x: auto;
    margin: 1rem 0;
    font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
    font-size: 0.7rem;
    line-height: 1.4;
    color: #333;
}

.inline-code { 
    background: #f5f5f5; 
    padding: 0.15rem 0.3rem; 
    border: none;
    font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
    font-size: 0.7rem;
    color: #333;
}

.link { 
    color: #0066cc; 
    text-decoration: none; 
}

.link:hover { 
    text-decoration: underline;
}

.image { 
    max-width: 100%; 
    height: auto; 
    margin: 1rem 0; 
    border: none;
}

.unordered-list, .ordered-list { 
    margin: 1rem 0; 
    padding-left: 2rem; 
}

.list-item { 
    margin-bottom: 0.5rem; 
    line-height: 1.6;
    font-size: .9rem;
}

.blockquote { 
    border-left: 3px solid #ddd; 
    padding-left: 1rem; 
    margin: 0.5rem 0; 
    font-style: italic;
    color: #666;
    background: none;
    padding: 0.25rem 0.5rem;
    font-size: 0.9rem;
}

.strong { 
    font-weight: 600; 
    color: #333;
}

.emphasis { 
    font-style: italic; 
    color: #333;
}

.metadata {
    font-size: 0.8rem;
    color: #666;
    margin-top: 0.5rem;
    margin-bottom: 1rem;
}

.meta-field {
    margin-bottom: 0.25rem;
    line-height: 1.2rem;
}

.meta-field:last-child {
    margin-bottom: 0;
}

hr {
    border: none;
    height: 1px;
    background: #ddd;
    margin: 1.5rem 0;
}

/* Table Styles */
.table {
    width: 100%;
    border-collapse: collapse;
    margin: 1rem 0;
    font-size: 0.9rem;
    background: #fff;
    border: 1px solid #ddd;
}

.table th {
    background: #f8f9fa;
    border: 1px solid #ddd;
    padding: 0.75rem;
    text-align: left;
    font-weight: 600;
    color: #333;
}

.table td {
    border: 1px solid #ddd;
    padding: 0.75rem;
    text-align: left;
    vertical-align: top;
}

.table tr:nth-child(even) {
    background: #f8f9fa;
}

.table tr:hover {
    background: #f1f3f4;
}

.table-container {
    overflow-x: auto;
    margin: 1rem 0;
}

/* Table of Contents Styles */
.container {
    position: relative;
    max-width: 750px;
    margin: 0 auto;
}

.toc {
    position: fixed;
    top: 11.75rem;
    left: calc(50% - 625px);
    width: 200px;
    max-height: calc(100vh - 8rem);
    overflow-y: auto;
}

.toc-nav {
    margin: 0;
}

.toc-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.toc-list li {
    margin-bottom: 0.5rem;
}

.toc-link {
    display: block;
    padding: 0.25rem 0;
    color: #666;
    text-decoration: none;
    font-size: 0.85rem;
    line-height: 1.4;
    text-align: right;
    transition: color 0.2s ease;
}

.toc-link:hover {
    color: #0066cc;
    text-decoration: none;
}

.content {
    width: 100%;
}

/* Responsive design for mobile */
@media (max-width: 768px) {
    .toc {
        position: static;
        width: auto;
        max-height: none;
        margin-bottom: 1rem;
    }
    
    body {
        padding: 1rem;
    }
}

pre { line-height: 125%; }
td.linenos .normal { color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #666666; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
.highlight .hll { background-color: #ffffcc }
.highlight { background: #f0f0f0; }
.highlight .c { color: #60A0B0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #F00 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666 } /* Operator */
.highlight .ch { color: #60A0B0; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #60A0B0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .cpf { color: #60A0B0; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #60A0B0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60A0B0; background-color: #FFF0F0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .ges { font-weight: bold; font-style: italic } /* Generic.EmphStrong */
.highlight .gr { color: #F00 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888 } /* Generic.Output */
.highlight .gp { color: #C65D09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #04D } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40A070 } /* Literal.Number */
.highlight .s { color: #4070A0 } /* Literal.String */
.highlight .na { color: #4070A0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0E84B5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60ADD5 } /* Name.Constant */
.highlight .nd { color: #555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #D55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287E } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0E84B5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #BB60D5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #BBB } /* Text.Whitespace */
.highlight .mb { color: #40A070 } /* Literal.Number.Bin */
.highlight .mf { color: #40A070 } /* Literal.Number.Float */
.highlight .mh { color: #40A070 } /* Literal.Number.Hex */
.highlight .mi { color: #40A070 } /* Literal.Number.Integer */
.highlight .mo { color: #40A070 } /* Literal.Number.Oct */
.highlight .sa { color: #4070A0 } /* Literal.String.Affix */
.highlight .sb { color: #4070A0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070A0 } /* Literal.String.Char */
.highlight .dl { color: #4070A0 } /* Literal.String.Delimiter */
.highlight .sd { color: #4070A0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070A0 } /* Literal.String.Double */
.highlight .se { color: #4070A0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070A0 } /* Literal.String.Heredoc */
.highlight .si { color: #70A0D0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #C65D09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070A0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #06287E } /* Name.Function.Magic */
.highlight .vc { color: #BB60D5 } /* Name.Variable.Class */
.highlight .vg { color: #BB60D5 } /* Name.Variable.Global */
.highlight .vi { color: #BB60D5 } /* Name.Variable.Instance */
.highlight .vm { color: #BB60D5 } /* Name.Variable.Magic */
.highlight .il { color: #40A070 } /* Literal.Number.Integer.Long */
</style>
</head>
<body>
<div class="container">
<aside class="toc">
<nav class="toc-nav">
<ul class="toc-list">
<li><a href="#overview" class="toc-link">Overview</a></li>
<li><a href="#basic-usage" class="toc-link">Basic Usage</a></li>
<li><a href="#integration-with-existing-parser" class="toc-link">Integration with Existing Parser</a></li>
<li><a href="#frontmatterblockelement" class="toc-link">FrontmatterBlockElement</a></li>
<li><a href="#error-handling" class="toc-link">Error Handling</a></li>
<li><a href="#example-with-renderer" class="toc-link">Example with Renderer</a></li>
<li><a href="#advanced-usage" class="toc-link">Advanced Usage</a></li>
<li><a href="#best-practices" class="toc-link">Best Practices</a></li>
<li><a href="#troubleshooting" class="toc-link">Troubleshooting</a></li>
<li><a href="#conclusion" class="toc-link">Conclusion</a></li>
</ul>
</nav>
</aside>
<main class="content">
<section>
<header>
<h1 class="title">Frontmatter Parsing</h1>
<div class='metadata'>
<div class="meta-field">Author: Michael Lutz</div>
<div class="meta-field">Date: 2025-07-02</div>
</div>
<hr />
</header>

<p class="paragraph">This document explains how to add YAML frontmatter support to the Marko parser system.</p>
<h1 id="overview" class="heading-1">Overview</h1>
<p class="paragraph">The frontmatter integration provides three main approaches:</p>
<ol class="ordered-list">
<li class="list-item"><strong class="strong">FrontmatterParser</strong>: A custom parser that extends Marko's Parser with frontmatter support</li>
<li class="list-item"><strong class="strong">FrontmatterExtractor</strong>: A utility class for extracting frontmatter without full parsing</li>
<li class="list-item"><strong class="strong">Convenience functions</strong>: Simple functions for common use cases</li>
</ol>
<h1 id="basic-usage" class="heading-1">Basic Usage</h1>
<h2 id="method-1-parse-with-frontmatter-support" class="heading-2">Method 1: Parse with Frontmatter Support</h2>
<div class="highlight"><pre class="code-block"><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">babbl.frontmatter_parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse_with_frontmatter</span>

<span class="n">content</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;---</span>
<span class="s2">title: &quot;My Document&quot;</span>
<span class="s2">author: &quot;John Doe&quot;</span>
<span class="s2">date: &quot;2024-01-15&quot;</span>
<span class="s2">---</span>

<span class="s2"># My Document</span>

<span class="s2">This is the content.</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">frontmatter</span><span class="p">,</span> <span class="n">document</span> <span class="o">=</span> <span class="n">parse_with_frontmatter</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Title: </span><span class="si">{</span><span class="n">frontmatter</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Author: </span><span class="si">{</span><span class="n">frontmatter</span><span class="p">[</span><span class="s1">&#39;author&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

<h2 id="method-2-extract-frontmatter-only" class="heading-2">Method 2: Extract Frontmatter Only</h2>
<div class="highlight"><pre class="code-block"><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">babbl.frontmatter_parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">extract_frontmatter_only</span>

<span class="n">frontmatter</span><span class="p">,</span> <span class="n">content_without_frontmatter</span> <span class="o">=</span> <span class="n">extract_frontmatter_only</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frontmatter: </span><span class="si">{</span><span class="n">frontmatter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Content: </span><span class="si">{</span><span class="n">content_without_frontmatter</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

<h2 id="method-3-use-parser-directly" class="heading-2">Method 3: Use Parser Directly</h2>
<div class="highlight"><pre class="code-block"><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">babbl.frontmatter_parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrontmatterParser</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">FrontmatterParser</span><span class="p">()</span>
<span class="n">frontmatter</span><span class="p">,</span> <span class="n">document</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_with_frontmatter</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</pre></div>

<h1 id="integration-with-existing-parser" class="heading-1">Integration with Existing Parser</h1>
<p class="paragraph">To add frontmatter support to an existing Marko parser:</p>
<div class="highlight"><pre class="code-block"><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">marko.parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">Parser</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">babbl.frontmatter_parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrontmatterBlockElement</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyCustomParser</span><span class="p">(</span><span class="n">Parser</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># Add frontmatter support</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_element</span><span class="p">(</span><span class="n">FrontmatterBlockElement</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">parse_with_frontmatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="n">document</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        
        <span class="c1"># Extract frontmatter</span>
        <span class="n">frontmatter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">document</span><span class="o">.</span><span class="n">children</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">document</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">FrontmatterBlockElement</span><span class="p">):</span>
            <span class="n">frontmatter</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">metadata</span>
            <span class="n">document</span><span class="o">.</span><span class="n">children</span> <span class="o">=</span> <span class="n">document</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        
        <span class="k">return</span> <span class="n">frontmatter</span><span class="p">,</span> <span class="n">document</span>
</pre></div>

<h1 id="frontmatterblockelement" class="heading-1">FrontmatterBlockElement</h1>
<p class="paragraph">The <code class="inline-code">FrontmatterBlockElement</code> is a custom block element that:</p>
<ul class="unordered-list">
<li class="list-item">Has high priority (10) to parse before other elements</li>
<li class="list-item">Only matches at the beginning of the document (pos == 0)</li>
<li class="list-item">Looks for YAML content between <code class="inline-code">---</code> delimiters</li>
<li class="list-item">Parses YAML content into a metadata dictionary</li>
</ul>
<h2 id="customization" class="heading-2">Customization</h2>
<p class="paragraph">You can customize the frontmatter element:</p>
<div class="highlight"><pre class="code-block"><span></span><span class="k">class</span><span class="w"> </span><span class="nc">CustomFrontmatterElement</span><span class="p">(</span><span class="n">FrontmatterBlockElement</span><span class="p">):</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># Higher priority</span>
    
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">match</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="c1"># Custom matching logic</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
    
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parse</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">source</span><span class="p">):</span>
        <span class="c1"># Custom parsing logic</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</pre></div>

<h1 id="error-handling" class="heading-1">Error Handling</h1>
<p class="paragraph">The frontmatter parser handles various error cases:</p>
<ol class="ordered-list">
<li class="list-item"><strong class="strong">Invalid YAML</strong>: If YAML parsing fails, returns <code class="inline-code">None</code> for frontmatter</li>
<li class="list-item"><strong class="strong">Missing delimiters</strong>: If no <code class="inline-code">---</code> delimiters found, treats as regular content</li>
<li class="list-item"><strong class="strong">Empty frontmatter</strong>: If frontmatter is empty, returns empty dict <code class="inline-code">{}</code></li>
</ol>
<h1 id="example-with-renderer" class="heading-1">Example with Renderer</h1>
<div class="highlight"><pre class="code-block"><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">babbl.frontmatter_parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse_with_frontmatter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">babbl.renderer</span><span class="w"> </span><span class="kn">import</span> <span class="n">HTMLRenderer</span>

<span class="c1"># Parse content with frontmatter</span>
<span class="n">frontmatter</span><span class="p">,</span> <span class="n">document</span> <span class="o">=</span> <span class="n">parse_with_frontmatter</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>

<span class="c1"># Render the document</span>
<span class="n">renderer</span> <span class="o">=</span> <span class="n">HTMLRenderer</span><span class="p">()</span>
<span class="n">html_content</span> <span class="o">=</span> <span class="n">renderer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>

<span class="c1"># Use frontmatter for template</span>
<span class="n">title</span> <span class="o">=</span> <span class="n">frontmatter</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;Untitled&#39;</span><span class="p">)</span>
<span class="n">author</span> <span class="o">=</span> <span class="n">frontmatter</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;author&#39;</span><span class="p">,</span> <span class="s1">&#39;Unknown&#39;</span><span class="p">)</span>

<span class="n">final_html</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;!DOCTYPE html&gt;</span>
<span class="s2">&lt;html&gt;</span>
<span class="s2">&lt;head&gt;</span>
<span class="s2">    &lt;title&gt;</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&lt;/title&gt;</span>
<span class="s2">    &lt;meta name=&quot;author&quot; content=&quot;</span><span class="si">{</span><span class="n">author</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<span class="s2">&lt;/head&gt;</span>
<span class="s2">&lt;body&gt;</span>
<span class="s2">    </span><span class="si">{</span><span class="n">html_content</span><span class="si">}</span>
<span class="s2">&lt;/body&gt;</span>
<span class="s2">&lt;/html&gt;</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>

<h1 id="advanced-usage" class="heading-1">Advanced Usage</h1>
<h2 id="custom-frontmatter-processing" class="heading-2">Custom Frontmatter Processing</h2>
<div class="highlight"><pre class="code-block"><span></span><span class="k">class</span><span class="w"> </span><span class="nc">AdvancedFrontmatterParser</span><span class="p">(</span><span class="n">FrontmatterParser</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parse_with_frontmatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="n">frontmatter</span><span class="p">,</span> <span class="n">document</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">parse_with_frontmatter</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        
        <span class="c1"># Process frontmatter</span>
        <span class="k">if</span> <span class="n">frontmatter</span><span class="p">:</span>
            <span class="c1"># Add computed fields</span>
            <span class="n">frontmatter</span><span class="p">[</span><span class="s1">&#39;word_count&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="n">frontmatter</span><span class="p">[</span><span class="s1">&#39;has_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;```&#39;</span> <span class="ow">in</span> <span class="n">text</span>
            
            <span class="c1"># Validate required fields</span>
            <span class="n">required_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="s1">&#39;author&#39;</span><span class="p">]</span>
            <span class="n">missing_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">field</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">required_fields</span> <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">frontmatter</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">missing_fields</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required fields: </span><span class="si">{</span><span class="n">missing_fields</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">frontmatter</span><span class="p">,</span> <span class="n">document</span>
</pre></div>

<h2 id="integration-with-existing-systems" class="heading-2">Integration with Existing Systems</h2>
<div class="highlight"><pre class="code-block"><span></span><span class="c1"># Integrate with existing frontmatter processing</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">babbl.frontmatter</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrontmatterProcessor</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IntegratedParser</span><span class="p">(</span><span class="n">FrontmatterParser</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frontmatter_processor</span> <span class="o">=</span> <span class="n">FrontmatterProcessor</span><span class="p">()</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">parse_with_frontmatter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
        <span class="c1"># Use existing frontmatter processor for sidecar files</span>
        <span class="c1"># and custom parser for inline frontmatter</span>
        <span class="n">frontmatter</span><span class="p">,</span> <span class="n">document</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">parse_with_frontmatter</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        
        <span class="c1"># Additional processing can be added here</span>
        <span class="k">return</span> <span class="n">frontmatter</span><span class="p">,</span> <span class="n">document</span>
</pre></div>

<h1 id="best-practices" class="heading-1">Best Practices</h1>
<ol class="ordered-list">
<li class="list-item"><strong class="strong">Always check for None</strong>: Frontmatter may be <code class="inline-code">None</code> if not present</li>
<li class="list-item"><strong class="strong">Use .get() method</strong>: Provides default values for missing keys</li>
<li class="list-item"><strong class="strong">Validate early</strong>: Check required fields before processing</li>
<li class="list-item"><strong class="strong">Handle errors gracefully</strong>: YAML parsing can fail</li>
<li class="list-item"><strong class="strong">Consider performance</strong>: For large documents, use <code class="inline-code">extract_frontmatter_only</code> if you only need metadata</li>
</ol>
<h1 id="troubleshooting" class="heading-1">Troubleshooting</h1>
<h2 id="common-issues" class="heading-2">Common Issues</h2>
<ol class="ordered-list">
<li class="list-item"><strong class="strong">Frontmatter not detected</strong>: Ensure <code class="inline-code">---</code> delimiters are at the very beginning</li>
<li class="list-item"><strong class="strong">YAML parsing errors</strong>: Check YAML syntax in frontmatter</li>
<li class="list-item"><strong class="strong">Parser conflicts</strong>: Ensure frontmatter element has appropriate priority</li>
<li class="list-item"><strong class="strong">Content corruption</strong>: Verify frontmatter is properly removed from content</li>
</ol>
<h2 id="debug-mode" class="heading-2">Debug Mode</h2>
<div class="highlight"><pre class="code-block"><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="c1"># This will show detailed parsing information</span>
<span class="n">frontmatter</span><span class="p">,</span> <span class="n">document</span> <span class="o">=</span> <span class="n">parse_with_frontmatter</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</pre></div>

<h1 id="conclusion" class="heading-1">Conclusion</h1>
<p class="paragraph">The frontmatter integration provides a flexible way to add YAML frontmatter support to the Marko parser system. It maintains compatibility with existing code while adding powerful metadata extraction capabilities. </p>

</section>
</main>
</div>
</body>
</html>